<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infraestructuras Digitales Globales</title>

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css" />
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 100%);
            color: #fff;
            overflow-x: hidden;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 30px 0;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #00d4ff, #0099ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            font-size: 1.1em;
            color: #8b9dc3;
            margin-bottom: 20px;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
            font-weight: 600;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.5s, height 0.5s;
        }

        .btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn-cables { background: linear-gradient(135deg, #00d4ff, #0099ff); color: #000; }
        .btn-satellites { background: linear-gradient(135deg, #ff6b6b, #ee5a6f); color: #fff; }
        .btn-data-centers { background: linear-gradient(135deg, #4ecdc4, #44a08d); color: #fff; }
        .btn:hover { transform: translateY(-3px); box-shadow: 0 8px 25px rgba(0, 212, 255, 0.5); }
        .btn.active { box-shadow: 0 0 25px rgba(0, 212, 255, 0.8); transform: translateY(-2px); }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.06);
            padding: 25px;
            border-radius: 12px;
            border: 1px solid rgba(0, 212, 255, 0.2);
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            backdrop-filter: blur(5px);
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 212, 255, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .stat-card:hover::before {
            left: 100%;
        }

        .stat-card:hover {
            transform: translateY(-8px);
            border-color: rgba(0, 212, 255, 0.6);
            box-shadow: 0 15px 40px rgba(0, 212, 255, 0.3);
            background: rgba(255, 255, 255, 0.09);
        }

        .stat-card h4 {
            color: #00d4ff;
            margin-bottom: 12px;
            font-size: 1.2em;
            font-weight: 700;
            position: relative;
            z-index: 1;
        }
        .stat-value {
            font-size: 2.2em;
            font-weight: bold;
            color: #fff;
            margin-bottom: 8px;
            position: relative;
            z-index: 1;
            background: linear-gradient(135deg, #00d4ff, #00ffff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .stat-label {
            color: #8b9dc3;
            font-size: 0.9em;
            position: relative;
            z-index: 1;
            line-height: 1.4;
        }

        .map-container {
            background: rgba(255, 255, 255, 0.03);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 2px solid rgba(0, 212, 255, 0.2);
            box-shadow: 0 5px 30px rgba(0, 0, 0, 0.3);
            position: relative;
        }

        #world-map {
            width: 100%;
            height: 700px;
            border-radius: 10px;
            z-index: 10;
        }

        .legend {
            position: absolute;
            bottom: 30px;
            right: 30px;
            background: rgba(10, 14, 39, 0.95);
            padding: 16px;
            border-radius: 8px;
            border: 1px solid rgba(0, 212, 255, 0.3);
            font-size: 11px;
            color: #8b9dc3;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        .legend-item {
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 2px;
        }

        .info-panel {
            position: fixed;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            width: 380px;
            background: rgba(10, 14, 39, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(0, 212, 255, 0.3);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            display: none;
            max-height: 85vh;
            overflow-y: auto;
            z-index: 1000;
        }

        .info-panel.active { display: block; }
        .info-panel h3 {
            color: #00d4ff;
            margin-bottom: 15px;
            font-size: 1.5em;
            border-bottom: 2px solid rgba(0, 212, 255, 0.3);
            padding-bottom: 10px;
        }

        .detail {
            margin-bottom: 12px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.08);
            border-left: 3px solid rgba(0, 212, 255, 0.5);
            border-radius: 6px;
            transition: all 0.3s ease;
        }

        .detail:hover {
            background: rgba(255, 255, 255, 0.12);
            border-left-color: rgba(0, 212, 255, 0.8);
        }

        .label {
            color: #8b9dc3;
            font-size: 0.85em;
            margin-bottom: 6px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }
        .value {
            color: #fff;
            font-weight: 500;
            font-size: 1em;
            line-height: 1.6;
            word-break: break-word;
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255, 107, 107, 0.2);
            border: none;
            color: #ff6b6b;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2em;
        }

        .close-btn:hover { background: rgba(255, 107, 107, 0.4); }

        /* Estilos para Leaflet */
        .leaflet-container {
            background: #0a1e3a !important;
        }

        .timeline-container {
            background: rgba(255, 255, 255, 0.06);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid rgba(0, 212, 255, 0.2);
            margin-bottom: 30px;
            backdrop-filter: blur(5px);
        }

        .timeline-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .timeline-header h3 {
            color: #00d4ff;
            font-size: 1.2em;
            margin: 0;
        }

        .year-display {
            background: linear-gradient(135deg, #00d4ff, #00ffff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 2em;
            font-weight: bold;
            min-width: 100px;
            text-align: right;
        }

        .timeline-slider {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: rgba(0, 212, 255, 0.2);
            outline: none;
            -webkit-appearance: none;
            cursor: pointer;
        }

        .timeline-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: linear-gradient(135deg, #00d4ff, #0099ff);
            cursor: pointer;
            box-shadow: 0 0 10px rgba(0, 212, 255, 0.8);
            transition: all 0.3s ease;
        }

        .timeline-slider::-webkit-slider-thumb:hover {
            width: 24px;
            height: 24px;
            box-shadow: 0 0 20px rgba(0, 212, 255, 1);
        }

        .timeline-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: linear-gradient(135deg, #00d4ff, #0099ff);
            cursor: pointer;
            border: none;
            box-shadow: 0 0 10px rgba(0, 212, 255, 0.8);
            transition: all 0.3s ease;
        }

        .timeline-slider::-moz-range-thumb:hover {
            width: 24px;
            height: 24px;
            box-shadow: 0 0 20px rgba(0, 212, 255, 1);
        }

        .timeline-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 0.9em;
            color: #8b9dc3;
        }

        .timeline-info {
            margin-top: 15px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.08);
            border-left: 3px solid rgba(0, 212, 255, 0.5);
            border-radius: 6px;
            font-size: 0.95em;
            color: #e0e0e0;
            line-height: 1.6;
        }

        .infrastructure-count {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .count-card {
            background: rgba(0, 212, 255, 0.1);
            padding: 12px;
            border-radius: 8px;
            border: 1px solid rgba(0, 212, 255, 0.3);
            text-align: center;
        }

        .count-card-label {
            font-size: 0.85em;
            color: #8b9dc3;
            margin-bottom: 5px;
            text-transform: uppercase;
        }

        .count-card-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #00ffff;
        }

        @media (max-width: 1200px) {
            .info-panel {
                right: 0; left: 0; bottom: 0; top: auto;
                transform: none;
                width: 100%;
                max-height: 50vh;
                border-radius: 15px 15px 0 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üåç Infraestructuras Digitales Globales</h1>
            <p class="subtitle">Mapa interactivo de cables submarinos, sat√©lites y centros de datos</p>
            <div class="controls">
                <button class="btn btn-cables active" onclick="toggleLayer('cables')">üåä Cables Submarinos</button>
                <button class="btn btn-satellites" onclick="toggleLayer('satellites')">üõ∞Ô∏è Sat√©lites</button>
                <button class="btn btn-data-centers" onclick="toggleLayer('datacenters')">üè¢ Centros de Datos</button>
            </div>
        </header>

        <div class="timeline-container">
            <div class="timeline-header">
                <h3>‚è±Ô∏è Filtro Hist√≥rico</h3>
                <div class="year-display" id="yearDisplay">2025</div>
            </div>
            <input type="range" min="1992" max="2025" value="2025" class="timeline-slider" id="timelineSlider">
            <div class="timeline-labels">
                <span>1992</span>
                <span>2000</span>
                <span>2010</span>
                <span>2020</span>
                <span>2025</span>
            </div>
            <div class="timeline-info" id="timelineInfo">
                Desliza el slider para ver la evoluci√≥n hist√≥rica de las infraestructuras digitales globales
            </div>
            <div class="infrastructure-count">
                <div class="count-card">
                    <div class="count-card-label">Cables Activos</div>
                    <div class="count-card-value" id="cableCount">12</div>
                </div>
                <div class="count-card">
                    <div class="count-card-label">Centros de Datos</div>
                    <div class="count-card-value" id="dcCount">12</div>
                </div>
                <div class="count-card">
                    <div class="count-card-label">Sat√©lites</div>
                    <div class="count-card-value" id="satCount">4</div>
                </div>
                <div class="count-card">
                    <div class="count-card-label">Inversi√≥n Total</div>
                    <div class="count-card-value" id="investmentCount">$30B</div>
                </div>
            </div>
        </div>

        <div class="stats">
            <div class="stat-card">
                <h4>üì° Cables Submarinos</h4>
                <div class="stat-value">500+</div>
                <div class="stat-label">Cables activos conectando continentes</div>
            </div>
            <div class="stat-card">
                <h4>üõ∞Ô∏è Sat√©lites</h4>
                <div class="stat-value">9,000+</div>
                <div class="stat-label">Sat√©lites LEO activos</div>
            </div>
            <div class="stat-card">
                <h4>üíæ Tr√°fico Global</h4>
                <div class="stat-value">99%</div>
                <div class="stat-label">Viaja por cables submarinos</div>
            </div>
            <div class="stat-card">
                <h4>üí∞ Inversi√≥n 2024-25</h4>
                <div class="stat-value">$30B+</div>
                <div class="stat-label">En infraestructura digital</div>
            </div>
        </div>

        <div class="map-container">
            <div id="world-map"></div>

            <div class="legend">
                <div style="font-size: 12px; color: #00d4ff; margin-bottom: 8px; font-weight: bold;">LEYENDA</div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #00d4ff;"></div>
                    <span>Cables submarinos</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #ff6b6b;"></div>
                    <span>Sat√©lites LEO</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #4ecdc4;"></div>
                    <span>Centros de datos</span>
                </div>
            </div>
        </div>
    </div>

    <div class="info-panel" id="infoPanel">
        <button class="close-btn" onclick="closePanel()">√ó</button>
        <div id="infoPanelContent"></div>
    </div>

    <!-- Leaflet JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>

    <script>
        // Datos de cables submarinos con informaci√≥n hist√≥rica
        const cables = [
            {name: 'SEA-ME-WE 3', length: '39,000 km', capacity: '15 Tb/s', year: 1999, route: 'Singapur ‚Üí Sud√°frica', countries: ['33 pa√≠ses'], cost: '$200M', owners: 'Consorcio 77 empresas', description: 'Uno de los primeros cables de larga distancia', coords: [[1.3, 103.8], [-33.9, 18.4]], historicalOwners: [{year: 1999, owners: 'Consorcio 77 empresas'}, {year: 2015, owners: 'Actualizaci√≥n de propietarios'}]},
            {name: 'MAREA', length: '6,600 km', capacity: '200 Tb/s', year: 2017, route: 'Bilbao (Espa√±a) ‚Üí Virginia Beach (EE.UU.)', countries: ['Espa√±a', 'EE.UU.'], cost: '$500M', owners: 'Microsoft, Meta, Telxius', description: 'Transatl√°ntico de mayor capacidad', coords: [[43.3, -2.9], [36.9, -75.9]], historicalOwners: [{year: 2017, owners: 'Microsoft, Meta, Telxius'}, {year: 2020, owners: 'Microsoft (mayor participaci√≥n)'}]},
            {name: '2Africa', length: '45,000 km', capacity: '180 Tb/s', year: 2024, route: 'Portugal ‚Üí Sud√°frica ‚Üí Nigeria', countries: ['33 pa√≠ses'], cost: '$1,000M+', owners: 'Meta, Google, Vodafone', description: 'Cable m√°s largo del mundo', coords: [[40.7, -8.2], [-33.9, 18.4], [6.5, 3.4]]},
            {name: 'Medusa', length: '8,700 km', capacity: '130 Tb/s', year: 2025, route: 'Mediterr√°neo completo', countries: ['9 pa√≠ses'], cost: '$700M', owners: 'Meta, Google, Vodafone', description: 'Cable crucial Mediterr√°neo', coords: [[38.7, -9.1], [41.4, 2.2], [43.3, 5.4], [40.9, 14.3], [31.2, 29.9]]},
            {name: 'Grace Hopper', length: '7,000 km', capacity: '340 Tb/s', year: 2022, route: 'Nueva York ‚Üí UK ‚Üí Bilbao', countries: ['EE.UU.', 'UK', 'Espa√±a'], cost: '$400M', owners: 'Google', description: 'Transatl√°ntico ultra-r√°pido', coords: [[40.7, -74.0], [50.8, -4.5], [43.3, -2.9]]},
            {name: 'PEACE', length: '15,000 km', capacity: '200 Tb/s', year: 2022, route: 'Pakist√°n ‚Üí Kenia ‚Üí Egipto ‚Üí Francia', countries: ['Pakist√°n', 'Kenia', 'Egipto', 'Francia'], cost: '$300M', owners: 'PEACE Cable International', description: 'Ruta Asia-Europa v√≠a √Åfrica', coords: [[24.9, 67.0], [-4.0, 39.7], [30.0, 31.2], [48.9, 2.4]]},
            {name: 'Echo', length: '5,800 km', capacity: '100 Tb/s', year: 2019, route: 'Martinica ‚Üí Francia', countries: ['Francia', 'Antillas'], cost: '$200M', owners: 'Google, Facebook', description: 'Cable Atl√°ntico Sur', coords: [[14.6, -61.0], [43.5, 1.4]]},
            {name: 'Equiano', length: '20,000 km', capacity: '180 Tb/s', year: 2023, route: 'Portugal ‚Üí Sud√°frica ‚Üí Nigeria', countries: ['20+ pa√≠ses africanos'], cost: '$500M', owners: 'Google', description: 'Infraestructura digital de √Åfrica', coords: [[40.7, -8.2], [-33.9, 18.4], [6.5, 3.4]]},
            {name: 'Dunant', length: '6,600 km', capacity: '200+ Tb/s', year: 2024, route: 'Bilbao ‚Üí Virginia', countries: ['Espa√±a', 'EE.UU.'], cost: '$400M', owners: 'Google, Meta', description: 'Transatl√°ntico de nueva generaci√≥n', coords: [[43.3, -2.9], [37.0, -75.5]]},
            {name: 'Apricot', length: '12,800 km', capacity: '200 Tb/s', year: 2024, route: 'Singapur ‚Üí India ‚Üí Djibouti ‚Üí Egipto', countries: ['M√∫ltiples'], cost: '$600M', owners: 'Google, Vodafone', description: 'Ruta Asia-Europa clave', coords: [[1.3, 103.8], [19.1, 72.9], [11.6, 43.1], [30.0, 31.2]]},
            {name: 'PAL', length: '18,800 km', capacity: '72 Tb/s', year: 2015, route: 'Tailandia ‚Üí Australia ‚Üí Singapur', countries: ['9 pa√≠ses Asia-Pac√≠fico'], cost: '$300M', owners: 'Google, Yahoo', description: 'Asia-Pac√≠fico crucial', coords: [[13.7, 100.5], [-25.3, 131.0], [1.3, 103.8]]},
            {name: 'FASTER', length: '6,600 km', capacity: '60 Tb/s', year: 2016, route: 'Jap√≥n ‚Üí USA', countries: ['Jap√≥n', 'EE.UU.'], cost: '$300M', owners: 'Google', description: 'Transpac√≠fico de alta velocidad', coords: [[35.7, 139.7], [37.8, -122.4]]},
            {name: 'PLCN', length: '12,800 km', capacity: '24 Tb/s', year: 2018, route: 'Hong Kong ‚Üí USA', countries: ['Hong Kong', 'EE.UU.'], cost: '$400M', owners: 'Google, Facebook', description: 'Pac√≠fico cr√≠tico', coords: [[22.3, 114.2], [37.8, -122.4]]}
        ];

        const satellites = [
            {name: 'Starlink', operator: 'SpaceX', count: '8,000+', altitude: '340-570 km', speed: '50-150 Mbps', cost: '$10B+', year: 2019, coverage: '125 pa√≠ses, 5M usuarios', coords: [[45, -100], [30, -80], [20, -40], [0, 0], [-20, 50], [-35, 150]]},
            {name: 'OneWeb', operator: 'Eutelsat/UK/Bharti', count: '648', altitude: '1,200 km', speed: '195 Mbps', cost: '$3.4B', year: 2023, coverage: 'Global B2B/Gov', coords: [[0, 0], [30, 30], [60, 60], [-30, -30]]},
            {name: 'Kuiper', operator: 'Amazon', count: '3,236 planeados', altitude: '590-630 km', cost: '$10B', year: 2025, coverage: 'En desarrollo', coords: [[-30, 120], [-20, 140], [0, 160], [20, 140], [30, 120]]},
            {name: 'IRIS¬≤', operator: 'Uni√≥n Europea', count: 'En desarrollo', altitude: 'LEO/MEO', cost: '‚Ç¨6B', year: 2027, coverage: 'Europa principalmente', coords: [[50, 10], [55, 20], [48, 15], [45, 5]]}
        ];

        const dataCenters = [
            {name: 'AWS-VA', location: 'Virginia, EE.UU.', operator: 'Amazon AWS', capacity: '>100MW', year: 2006, coords: [38.9, -77.5]},
            {name: 'Google-IA', location: 'Iowa, EE.UU.', operator: 'Google', capacity: '1,500MW', year: 2009, coords: [41.3, -95.9]},
            {name: 'MS-Dublin', location: 'Dubl√≠n, Irlanda', operator: 'Microsoft', capacity: '>100MW', year: 2009, coords: [53.3, -6.3]},
            {name: 'DE-CIX', location: 'Frankfurt, Alemania', operator: 'DE-CIX', capacity: '>12Tbps', year: 1995, coords: [50.1, 8.7]},
            {name: 'AMS-IX', location: '√Åmsterdam, Holanda', operator: 'AMS-IX', capacity: '>11Tbps', year: 1992, coords: [52.4, 4.9]},
            {name: 'Equinix-TY', location: 'Tokio, Jap√≥n', operator: 'Equinix', capacity: '>200MW', year: 2001, coords: [35.7, 139.7]},
            {name: 'SG-Equinix', location: 'Singapur', operator: 'Equinix', capacity: '>500MW', year: 2000, coords: [1.3, 103.8]},
            {name: 'AWS-SY', location: 'Sydney, Australia', operator: 'Amazon AWS', capacity: '>100MW', year: 2014, coords: [-33.9, 151.2]},
            {name: 'Google-SP', location: 'S√£o Paulo, Brasil', operator: 'Google', capacity: '>100MW', year: 2018, coords: [-23.6, -46.6]},
            {name: 'AWS-LDN', location: 'Londres, UK', operator: 'Amazon AWS', capacity: '>100MW', year: 2009, coords: [51.5, -0.1]},
            {name: 'MS-SY', location: 'Sydney, Australia', operator: 'Microsoft', capacity: '>200MW', year: 2015, coords: [-33.9, 151.3]},
            {name: 'Alibaba-SH', location: 'Shangh√°i, China', operator: 'Alibaba', capacity: '>500MW', year: 2010, coords: [31.2, 121.5]}
        ];

        let map;
        let cableLines = [];
        let satelliteMarkers = [];
        let dataCenterMarkers = [];
        let active = {cables: true, satellites: false, datacenters: false};

        function initMap() {
            // Crear mapa
            map = L.map('world-map').setView([20, 0], 2);

            // A√±adir capa de mapa base oscuro
            L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
                attribution: '¬© OpenStreetMap contributors, ¬© CARTO',
                maxZoom: 19
            }).addTo(map);

            // No dibujar elementos inicialmente - se dibujar√°n desde filterByYear
        }

        function showInfo(type, data) {
            const panel = document.getElementById('infoPanel');
            const content = document.getElementById('infoPanelContent');
            let html = '';

            if(type === 'cable') {
                html = `<h3>üåä ${data.name}</h3>
                    <div class="detail"><div class="label">Ruta</div><div class="value">${data.route}</div></div>
                    <div class="detail"><div class="label">Longitud</div><div class="value">${data.length}</div></div>
                    ${data.capacity ? `<div class="detail"><div class="label">Capacidad</div><div class="value">${data.capacity}</div></div>` : ''}
                    <div class="detail"><div class="label">A√±o de activaci√≥n</div><div class="value">${data.year}</div></div>
                    <div class="detail"><div class="label">Pa√≠ses</div><div class="value">${data.countries.join(', ')}</div></div>
                    <div class="detail"><div class="label">Coste de infraestructura</div><div class="value">${data.cost}</div></div>
                    <div class="detail"><div class="label">Propietarios/Operadores</div><div class="value">${data.owners}</div></div>
                    <div class="detail"><div class="label">Descripci√≥n</div><div class="value">${data.description}</div></div>`;
            } else if(type === 'satellite') {
                html = `<h3>üõ∞Ô∏è ${data.name}</h3>
                    <div class="detail"><div class="label">Operador</div><div class="value">${data.operator}</div></div>
                    <div class="detail"><div class="label">Sat√©lites en √≥rbita</div><div class="value">${data.count}</div></div>
                    <div class="detail"><div class="label">Altitud</div><div class="value">${data.altitude}</div></div>
                    ${data.speed ? `<div class="detail"><div class="label">Velocidad de conexi√≥n</div><div class="value">${data.speed}</div></div>` : ''}
                    <div class="detail"><div class="label">Coste de desarrollo</div><div class="value">${data.cost}</div></div>
                    <div class="detail"><div class="label">Periodo de despliegue</div><div class="value">${data.year}</div></div>
                    <div class="detail"><div class="label">Cobertura</div><div class="value">${data.coverage}</div></div>`;
            } else if(type === 'dc') {
                html = `<h3>üè¢ ${data.name}</h3>
                    <div class="detail"><div class="label">Ubicaci√≥n</div><div class="value">${data.location}</div></div>
                    <div class="detail"><div class="label">Operador</div><div class="value">${data.operator}</div></div>
                    ${data.capacity ? `<div class="detail"><div class="label">Capacidad</div><div class="value">${data.capacity}</div></div>` : ''}
                    <div class="detail"><div class="label">A√±o de establecimiento</div><div class="value">${data.year}</div></div>`;
            }

            content.innerHTML = html;
            panel.classList.add('active');
        }

        function closePanel() {
            document.getElementById('infoPanel').classList.remove('active');
        }

        function toggleLayer(layer) {
            active[layer] = !active[layer];

            if(layer === 'cables') {
                cableLines.forEach(line => {
                    if(active.cables) map.addLayer(line);
                    else map.removeLayer(line);
                });
            } else if(layer === 'satellites') {
                satelliteMarkers.forEach(marker => {
                    if(active.satellites) map.addLayer(marker);
                    else map.removeLayer(marker);
                });
            } else if(layer === 'datacenters') {
                dataCenterMarkers.forEach(marker => {
                    if(active.datacenters) map.addLayer(marker);
                    else map.removeLayer(marker);
                });
            }

            // Actualizar botones
            document.querySelectorAll('.btn').forEach(b => {
                const t = b.textContent.toLowerCase();
                if((layer==='cables'&&t.includes('cables'))||(layer==='satellites'&&t.includes('sat√©lites'))||(layer==='datacenters'&&t.includes('centros'))) {
                    b.classList.toggle('active', active[layer]);
                }
            });
        }

        // Variables para el timeline
        let currentYear = 2025;
        let cableMarkers = [];
        let dcMarkers = [];
        let satMarkers = [];

        // Funci√≥n para filtrar infraestructuras por a√±o
        function filterByYear(year) {
            currentYear = year;
            document.getElementById('yearDisplay').textContent = year;

            // Limpiar marcadores anteriores
            cableMarkers.forEach(m => map.removeLayer(m));
            dcMarkers.forEach(m => map.removeLayer(m));
            satMarkers.forEach(m => map.removeLayer(m));
            cableMarkers = [];
            dcMarkers = [];
            satMarkers = [];

            // Dibujar cables del a√±o
            cables.forEach(cable => {
                if (cable.year <= year) {
                    const latlngs = cable.coords;
                    const polyline = L.polyline(latlngs, {
                        color: cable.year <= year - 5 ? '#0099ff' : '#00d4ff',
                        weight: 2.5,
                        opacity: 0.8,
                        dashArray: 'none'
                    }).addTo(map);

                    polyline.on('click', () => showInfoWithYear('cable', cable, year));
                    polyline.on('mouseover', function() {
                        this.setStyle({color: '#00ffff', weight: 4, opacity: 1});
                    });
                    polyline.on('mouseout', function() {
                        this.setStyle({color: cable.year <= year - 5 ? '#0099ff' : '#00d4ff', weight: 2.5, opacity: 0.8});
                    });

                    cableMarkers.push(polyline);

                    // Marcadores en puntos
                    latlngs.forEach(point => {
                        const marker = L.circleMarker(point, {
                            radius: 3,
                            fillColor: '#00ffff',
                            color: '#ffffff',
                            weight: 1.5,
                            opacity: 1,
                            fillOpacity: 0.8
                        }).addTo(map);

                        marker.on('click', () => showInfoWithYear('cable', cable, year));
                        cableMarkers.push(marker);
                    });
                }
            });

            // Dibujar sat√©lites del a√±o
            satellites.forEach(satellite => {
                if (satellite.year && satellite.year <= year) {
                    satellite.coords.forEach(coord => {
                        const marker = L.circleMarker(coord, {
                            radius: 4,
                            fillColor: '#ff6b6b',
                            color: '#ff9999',
                            weight: 1.5,
                            opacity: 1,
                            fillOpacity: 0.9
                        }).addTo(map);

                        marker.on('click', () => showInfoWithYear('satellite', satellite, year));
                        satMarkers.push(marker);
                    });
                }
            });

            // Dibujar centros de datos del a√±o
            dataCenters.forEach(dc => {
                if (dc.year <= year) {
                    const marker = L.circleMarker(dc.coords, {
                        radius: 4,
                        fillColor: '#4ecdc4',
                        color: '#3db8ae',
                        weight: 1.5,
                        opacity: 1,
                        fillOpacity: 0.9
                    }).addTo(map);

                    marker.bindPopup(`<strong>${dc.name}</strong><br>${dc.location}`);
                    marker.on('click', () => showInfoWithYear('dc', dc, year));
                    dcMarkers.push(marker);
                }
            });

            // Actualizar estad√≠sticas
            updateStats(year);
        }

        function showInfoWithYear(type, data, year) {
            const panel = document.getElementById('infoPanel');
            const content = document.getElementById('infoPanelContent');
            let html = '';

            if(type === 'cable') {
                let ownerInfo = data.owners;
                if(data.historicalOwners) {
                    const relevantOwner = data.historicalOwners.find(o => o.year <= year);
                    if(relevantOwner) {
                        ownerInfo = relevantOwner.owners + ` <span style="color: #8b9dc3;">(A√±o ${year})</span>`;
                    }
                }
                html = `<h3>üåä ${data.name}</h3>
                    <div class="detail"><div class="label">Ruta</div><div class="value">${data.route}</div></div>
                    <div class="detail"><div class="label">Longitud</div><div class="value">${data.length}</div></div>
                    ${data.capacity ? `<div class="detail"><div class="label">Capacidad</div><div class="value">${data.capacity}</div></div>` : ''}
                    <div class="detail"><div class="label">A√±o de activaci√≥n</div><div class="value">${data.year}</div></div>
                    <div class="detail"><div class="label">Propietarios/Operadores</div><div class="value">${ownerInfo}</div></div>
                    <div class="detail"><div class="label">Pa√≠ses</div><div class="value">${data.countries.join(', ')}</div></div>
                    <div class="detail"><div class="label">Descripci√≥n</div><div class="value">${data.description}</div></div>`;
            } else if(type === 'satellite') {
                html = `<h3>üõ∞Ô∏è ${data.name}</h3>
                    <div class="detail"><div class="label">Operador</div><div class="value">${data.operator}</div></div>
                    <div class="detail"><div class="label">Sat√©lites en √≥rbita</div><div class="value">${data.count}</div></div>
                    <div class="detail"><div class="label">Altitud</div><div class="value">${data.altitude}</div></div>
                    ${data.speed ? `<div class="detail"><div class="label">Velocidad de conexi√≥n</div><div class="value">${data.speed}</div></div>` : ''}
                    <div class="detail"><div class="label">Coste de desarrollo</div><div class="value">${data.cost}</div></div>
                    <div class="detail"><div class="label">Periodo de despliegue</div><div class="value">${data.year}</div></div>
                    <div class="detail"><div class="label">Cobertura</div><div class="value">${data.coverage}</div></div>`;
            } else if(type === 'dc') {
                html = `<h3>üè¢ ${data.name}</h3>
                    <div class="detail"><div class="label">Ubicaci√≥n</div><div class="value">${data.location}</div></div>
                    <div class="detail"><div class="label">Operador</div><div class="value">${data.operator}</div></div>
                    ${data.capacity ? `<div class="detail"><div class="label">Capacidad</div><div class="value">${data.capacity}</div></div>` : ''}
                    <div class="detail"><div class="label">A√±o de establecimiento</div><div class="value">${data.year}</div></div>`;
            }

            content.innerHTML = html;
            panel.classList.add('active');
        }

        function updateStats(year) {
            const activeCables = cables.filter(c => c.year <= year).length;
            const activeDCs = dataCenters.filter(d => d.year <= year).length;
            const activeSats = satellites.filter(s => s.year && s.year <= year).length;

            let totalInvestment = 0;
            cables.forEach(c => {
                if(c.year <= year) {
                    const cost = c.cost.replace(/[^\d]/g, '');
                    totalInvestment += parseInt(cost) || 0;
                }
            });

            dataCenters.forEach(d => {
                if(d.year <= year) {
                    totalInvestment += 50; // Estimaci√≥n por centro
                }
            });

            document.getElementById('cableCount').textContent = activeCables;
            document.getElementById('dcCount').textContent = activeDCs;
            document.getElementById('satCount').textContent = activeSats;
            document.getElementById('investmentCount').textContent = `$${totalInvestment}M`;

            // Actualizar informaci√≥n del timeline
            let timelineText = `En ${year}: `;
            if(year < 2000) {
                timelineText += 'Era de los primeros cables transatl√°nticos. Internet a√∫n estaba en expansi√≥n temprana.';
            } else if(year < 2010) {
                timelineText += 'Crecimiento acelerado de infraestructura. Primeras megacables de larga distancia.';
            } else if(year < 2020) {
                timelineText += 'Expansi√≥n global masiva. Tecnol√≥gicas (Google, Facebook, Amazon) comienzan a invertir.';
            } else {
                timelineText += 'Era actual: Las grandes tecnol√≥gicas controlan la mayor√≠a de nueva infraestructura.';
            }
            document.getElementById('timelineInfo').textContent = timelineText;
        }

        // Inicializar cuando se carga la p√°gina
        window.addEventListener('load', function() {
            initMap();

            // Configurar event listener para el slider
            document.getElementById('timelineSlider').addEventListener('input', function(e) {
                filterByYear(parseInt(e.target.value));
            });

            // Inicializar con a√±o actual
            filterByYear(2025);
        });
    </script>
</body>
</html>
